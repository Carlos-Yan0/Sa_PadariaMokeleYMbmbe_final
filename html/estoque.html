<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Estoque</title>

    <link rel="stylesheet" href="../css/menu.css">
    <link rel="stylesheet" href="../css/padrao.css">
    <link rel="stylesheet" href="../css/tabelas .css">
    <link rel="stylesheet" href="../css/popups.css">
    <link rel="stylesheet" href="../css/estoque.css">

    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet" />

    <script src="../js/add-estoque-popup.js"></script>
    <script src="../js/remove-estoque-popup.js"></script>
    <script src="../js/acesso-paginas.js" defer></script>

    <link rel="icon" href="../img/icon.png" type="image/png">
    <meta charset="UTF-8">
</head>

<body>

    <nav class="menu-lateral">
        <div class="cabeca-do-menu">
            <img src="../img/icon.png" alt="Logo Da Padaria Mokele y Mbembe" class="logo">
            <h1>Padaria<br>Mokele y Mbembe</h1>
        </div>

        <ul>
            <li class="item-menu">
                <a href="./home.html">
                    <span class="icon">
                        <span class="material-symbols-outlined">home</span>
                    </span>
                    <span class="nome-do-link">Home</span>
                </a>
            </li>
            <li class="item-menu">
                <a href="./pdv.html">
                    <span class="icon">
                        <span class="material-symbols-outlined">shopping_cart</span>
                    </span>
                    <span class="nome-do-link">Sistema de Vendas</span>
                </a>
            </li>
            <li class="item-menu">
                <a href="./dashboard.html">
                    <span class="icon">
                        <span class="material-symbols-outlined">monitoring</span>
                    </span>
                    <span class="nome-do-link">Graphic</span>
                </a>
            </li>
            <li class="item-menu">
                <a href="./historico-vendas.html">
                    <span class="icon">
                        <span class="material-symbols-outlined">receipt_long</span>
                    </span>
                    <span class="nome-do-link">Histórico de Vendas</span>
                </a>
            </li>
            <li class="item-menu">
                <a href="./estoque.html">
                    <span class="icon">
                        <span class="material-symbols-outlined">inventory_2</span>
                    </span>
                    <span class="nome-do-link">Estoque</span>
                </a>
            </li>
            <!-- <li class="item-menu">
                <a href="./fornecedor.html">
                    <span class="icon">
                        <span class="material-symbols-outlined">local_shipping</span>
                    </span>
                    <span class="nome-do-link">fornecedor</span>
                </a>
            </li> -->
            <li class="item-menu">
                <a href="./ge_usuarios.html">
                    <span class="icon">
                        <span class="material-symbols-outlined">groups</span>
                    </span>
                    <span class="nome-do-link">Gestão de Usuários</span>
                </a>
            </li>
            <li class="item-menu">
                <a href="./comanda.html">
                    <span class="icon">
                        <span class="material-symbols-outlined">confirmation_number</span>
                    </span>
                    <span class="nome-do-link">Emissão de Comandas</span>
                </a>
            </li>
            <li class="item-menu">
                <a href="./login.html">
                    <span class="icon">
                        <span class="material-symbols-outlined">logout</span>
                    </span>
                    <span class="nome-do-link">Logout</span>
                </a>
            </li>
        </ul>
    </nav>

    <main>
        <header class="titulo-de-pagina">
            <h1>Estoque</h1>
        </header>

        <div id="campoTabela">
            <button class="export">Exportar</button>
            <button class="add" onclick="mostrarPopupAdicionar()">Adicionar Item</button>
        </div>
        <form id="form-filtros" autocomplete="off">
            <input id="nome-form" type="text" name="nome-form" placeholder="Nome do Produto">
            <select id="categoria-form" name="categoria-form">
            <option value="">Categoria</option>
            <option value="Insumo">Insumo</option>
            <option value="Produto">Produto</option>
            </select>
            <input id="medida-form" type="text" name="medida-form" placeholder="Unidade de Medida">
            <select id="status-form" name="status-form">
            <option value="">Status</option>
            <option value="OK">OK</option>
            <option value="Atenção">Atenção</option>
            <option value="Baixo">Baixo</option>
            </select>
            <button id="filtrar">Filtrar</button>
        </form>

        <div class="tabela-container">
            <table id="tabelaEstoque">
                <thead>
                    <!-- Cabeçalho da tabela -->
                    <tr>
                        <th>Id</th>
                        <th>Nome</th>
                        <th>Categoria</th>
                        <th>Medida</th>
                        <th>Val Uni</th>
                        <th>Qtde</th>
                        <th>Val Inventário</th>
                        <th>Qtde Mínima</th>
                        <th>Validade</th>
                        <th>Status</th>
                        <th>Ações</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Itens fictícios -->
                    <tr id="row1">
                        <td>1</td>
                        <td>Pão Francês</td>
                        <td>Produto</td>
                        <td>UN</td>
                        <td>0,50</td>
                        <td>200</td>
                        <td>100,00</td>
                        <td>50</td>
                        <td>2025-12-31</td>
                        <td><span class="status-ok">OK</span></td>
                        <td>
                            <button class="edit-btn" onclick="editarLinha(this)">
                                <span class="material-symbols-outlined">edit</span>
                            </button>
                            <button class="delete-btn" onclick="mostrarPopupRemover(this)">
                                <span class="material-symbols-outlined">delete</span>
                            </button>
                        </td>
                    </tr>
                    <tr id="row2">
                        <td>2</td>
                        <td>Farinha de Trigo</td>
                        <td>Insumo</td>
                        <td>Kg</td>
                        <td>3,00</td>
                        <td>50</td>
                        <td>150,00</td>
                        <td>10</td>
                        <td>2025-11-30</td>
                        <td><span class="status-atencao">Atenção</span></td>
                        <td>
                            <button class="edit-btn" onclick="editarLinha(this)">
                                <span class="material-symbols-outlined">edit</span>
                            </button>
                            <button class="delete-btn" onclick="mostrarPopupRemover(this)">
                                <span class="material-symbols-outlined">delete</span>
                            </button>
                        </td>
                    </tr>
                    <tr id="row3">
                        <td>3</td>
                        <td>Leite</td>
                        <td>Insumo</td>
                        <td>L</td>
                        <td>4,50</td>
                        <td>10</td>
                        <td>45,00</td>
                        <td>5</td>
                        <td>2025-10-15</td>
                        <td><span class="status-baixo">Baixo</span></td>
                        <td>
                            <button class="edit-btn" onclick="editarLinha(this)">
                                <span class="material-symbols-outlined">edit</span>
                            </button>
                            <button class="delete-btn" onclick="mostrarPopupRemover(this)">
                                <span class="material-symbols-outlined">delete</span>
                            </button>
                        </td>
                    </tr>
                </tbody>
            </table>

            <!-- Filtro -->

            <script>
                document.getElementById("form-filtros").addEventListener("submit", function (e) {
                    e.preventDefault(); // Evita reload da página

                    const nome = document.getElementById("nome-form").value.toLowerCase();
                    const categoria = document.getElementById("categoria-form").value.toLowerCase();
                    const medida = document.getElementById("medida-form").value.toLowerCase();
                    const status = document.getElementById("status-form").value.toLowerCase();

                    const linhas = document.querySelectorAll("#tabelaEstoque tbody tr");

                    linhas.forEach(linha => {
                        const colunas = linha.querySelectorAll("td");

                        const colNome = colunas[1]?.textContent.toLowerCase() || "";
                        const colCategoria = colunas[2]?.textContent.toLowerCase() || "";
                        const colMedida = colunas[3]?.textContent.toLowerCase() || "";
                        const colStatus = colunas[9]?.textContent.toLowerCase() || "";

                        const matchNome = colNome.includes(nome);
                        const matchCategoria = colCategoria.includes(categoria);
                        const matchMedida = colMedida.includes(medida);
                        const matchStatus = colStatus.includes(status);

                        if (matchNome && matchCategoria && matchMedida && matchStatus) {
                            linha.style.display = "";
                        } else {
                            linha.style.display = "none";
                        }
                    });
                });
            </script>

        </div>
    </main>

    <footer id="footer-principal">
        <span class="footer-esquerdo">Usuário: João Mbembe Gerente</span>
        <span class="footer-direito">Copyright 2025-2025</span>
    </footer>

    <div id="backdrop-popup"></div>
    <div class="popup" id="popup-add">
        <form action="#" id="form-adicionar">
            <label for="nome-produto">Nome do Produto:</label>

            <input type="text" id="nome-produto" placeholder="Nome" required>

            <label for="categoria">Categoria:</label>
            <select id="categoria" required>
                <option value="Insumo">Insumo</option>
                <option value="Produto">Produto</option>
            </select>
            <label for="medida">Unidade de Medida:</label>
            <select id="medida" required>
                <option value="UN">UN</option>
                <option value="Kg">Kg</option>
                <option value="L">L</option>
            </select>
            <label for="valor-unitario-produto">Valor Unitário do Produto:</label>
            <input type="number" id="valor-unitario-produto" placeholder="Valor Unitário do Produto" required min="0"
                step="0.01" class="sem-spinners">

            <label for="quantidade-produto">Quantidade do Produto:</label>
            <input type="number" id="quantidade-produto" placeholder="Quantidade do Produto" required min="0"
                class="sem-spinners">

            <label for="quantidade-minima">Quantidade Mínima:</label>
            <input type="number" id="quantidade-minima" placeholder="Quantidade Mínima" required min="0"
                class="sem-spinners">
            <label for="validade">Validade</label>
            <input type="date" id="validade" required title="Escolha uma data e hora">
            <div class="botoes-popup">
                <button type="reset" id="cancelar-adicionar" onclick="fecharAdicionar()">Cancelar</button>
                <button type="button" id="adicionar-produto" onclick="fecharAdicionar()">Adicionar Produto</button>
            </div>
            <!-- Adicione aqui futuramente uma função para adicionar o produto -->
        </form>
    </div>
    <div class="popup" id="popup-remove">
        <div class="campo-informacoes">
            <h2>Remover Produto</h2>
            <p>Para remover um produto, é necessária a autenticação de um usuário com permissões administradoras
                (Gerente)</p>
        </div>
        <form action="#" id="form-remover">
            <label for="usuario">Usuário:</label>
            <input type="text" id="usuario" placeholder="Usuário" required>
            <label for="senha">Senha:</label>
            <input type="password" id="senha" placeholder="Senha" required>

            <div class="botoes-popup">
                <button type="reset" id="cancelar-remover" onclick="fecharRemover()">Cancelar</button>
                <button type="button" id="verificar-identidade" onclick="confirmarIdentidade()">Continuar</button>
            </div>
        </form>
    </div>

    <script src="../js/estoque.js"></script>
    <footer id="footer-principal">
        <span class="footer-esquerdo">Usuário: <span id="nomeUsuarioFooter"></span></span>
        <span class="footer-direito">Copyright 2025-2025</span>
    </footer>

    <script>
        const usuarioLogado = JSON.parse(localStorage.getItem('usuarioLogado'));
        if (usuarioLogado) {
            document.getElementById('nomeUsuarioFooter').textContent = usuarioLogado.nome;
        }
    </script>
</body>

</html>