<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../css/menu.css">
    <link rel="stylesheet" href="../css/padrao.css">
    <link rel="stylesheet" href="../css/dashboard.css">
    <link rel="stylesheet" href="../css/home.css">

    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

    <link rel="icon" href="../img/icon.png" type="image/png">
    <script src="../js/acesso-paginas.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>



    <title>Painel Gerente</title>
</head>

<body>

    <nav class="menu-lateral">
        <div class="cabeca-do-menu">
            <img src="../img/icon.png" alt="Logo Da Padaria Mokele y Mbembe" class="logo">
            <h1>Padaria<br>Mokele y Mbembe</h1>
        </div>

        <ul>
            <li class="item-menu">
                <a href="./home.html">
                    <span class="icon">
                        <span class="material-symbols-outlined">home</span>
                    </span>
                    <span class="nome-do-link">Home</span>
                </a>
            </li>
            <li class="item-menu">
                <a href="./pdv.html">
                    <span class="icon">
                        <span class="material-symbols-outlined">shopping_cart</span>
                    </span>
                    <span class="nome-do-link">Sistema de Vendas</span>
                </a>
            </li>
            <li class="item-menu">
                <a href="./dashboard.html">
                    <span class="icon">
                        <span class="material-symbols-outlined">dashboard</span>
                    </span>
                    <span class="nome-do-link">Graphic</span>
                </a>
            </li>
            <li class="item-menu">
                <a href="./historico-vendas.html">
                    <span class="icon">
                        <span class="material-symbols-outlined">receipt_long</span>
                    </span>
                    <span class="nome-do-link">Histórico de Vendas</span>
                </a>
            </li>
            <li class="item-menu">
                <a href="./estoque.html">
                    <span class="icon">
                        <span class="material-symbols-outlined">inventory_2</span>
                    </span>
                    <span class="nome-do-link">Estoque</span>
                </a>
            </li>
            <li class="item-menu">
                <a href="./fornecedor.html">
                    <span class="icon">
                        <span class="material-symbols-outlined">local_shipping</span>
                    </span>
                    <span class="nome-do-link">fornecedor</span>
                </a>
            </li>
            <li class="item-menu">
                <a href="./ge_usuarios.html">
                    <span class="icon">
                        <span class="material-symbols-outlined">groups</span>
                    </span>
                    <span class="nome-do-link">Gestão de Usuários</span>
                </a>
            </li>
            <li class="item-menu">
                <a href="./comanda.html">
                    <span class="icon">
                        <span class="material-symbols-outlined">confirmation_number</span>
                    </span>
                    <span class="nome-do-link">Emissão de Comandas</span>
                </a>
            </li>
            <li class="item-menu">
                <a href="./login.html">
                    <span class="icon">
                        <span class="material-symbols-outlined">logout</span>
                    </span>
                    <span class="nome-do-link">Logout</span>
                </a>
            </li>
        </ul>
    </nav>

    <main class="back">
        <header class="titulo-de-pagina">
            <h1>Bem-vindo, <span id="nomeUsuarioDisplay"></span>!</h1>
        </header>

        
        <section class="graficos">
            <h1 style="margin: 0 auto; font-size: 2em;">Status do Sistema</h1>

            <div>
                <h2>Status dos PDVs</h2>
                <ul id="statusPdvs"></ul>
            </div>
            <div>
                <h2>Comandas</h2>
                <p>Comandas abertas: <span id="comandasAbertas">0</span></p>
                <p>Comandas encerradas hoje: <span id="comandasEncerradas">0</span></p>
            </div>
            <div>
                <h2>Alerta de Estoque</h2>
                <ul id="alertaEstoqueBaixo" style="color:#fc5050; font-weight:bold; padding-left: 24px;"></ul>
            </div>
        </section>
        
        <div class="container">
            <h1 style="margin: 0 auto; font-size: 2em;">Acesso Rápido</h1>
            <a href="pdv.html">
                <div class="card" id="button-vendas"><span class="material-symbols-outlined">Shopping_Cart</span>
                    <h1>Sistema de Vendas</h1>
                    <p>Sistema completo para realizar vendas com integração às comandas</p>
                </div>
            </a>
            <a href="dashboard.html">
                <div class="card" id="button-dashboard"><span class="material-symbols-outlined">Monitoring</span><span>
                        <h1>Visão Geral</h1>
                        <p>Analise as vendas da padaria em forma de gráficos</p>
                </div>
            </a>
            <a href="historico-vendas.html">
                <div class="card" id="button-historico"><span class="material-symbols-outlined">history</span><span>
                        <h1>Histórico</h1>
                        <p>Acompanhe as últimas vendas da padaria</p>
                </div>
            </a>
            <a href="estoque.html">
                <div class="card" id="button-estoque"><span class="material-symbols-outlined">inventory_2</span><span>
                        <h1>Estoque</h1>
                        <p>Gerenciamento do estoque de produtos vendidos na padaria</p>
                </div>
            </a>
            <a href="ge_usuarios.html">
                <div class="card" id="button-usuario"><span class="material-symbols-outlined">Group</span><span>
                        <h1>Usuário</h1>
                        <p>Gerencie os usuários, suas senhas, <br>e-mails e níveis de acesso</p>
                </div>
            </a>
            <a href="comanda.html">
                <div class="card" id="button-comanda"><span class="material-symbols-outlined">receipt_long</span>
                    <h1>Comanda</h1>
                    <p>Sistema completo para emissão de comandas</p>
                </div>
            </a>
        </div>
        
        <section class="graficos">
            <h1 style="margin: 0 auto; font-size: 2em;">Dia de Hoje</h1>
            <!-- Vendas do Dia -->
            <div>
                <h2>Total de itens vendidos hoje: <span id="totalVendasHoje">0</span></h2>
                <canvas id="vendasPorHora" width="400" height="220"></canvas>
            </div>
            <!-- Produtos Mais Vendidos -->
            <div>
                <h2>Top Produtos Vendidos</h2>
                <ol id="topProdutosVendidos"></ol>
            </div>
            <div>
                <h2>Movimentação por Faixa de Horário</h2>
                <canvas id="movimentacaoHorario" width="400" height="220"></canvas>
            </div>
        </section>
    </main>

    <footer id="footer-principal">
        <span class="footer-esquerdo">Usuário: <span id="nomeUsuarioFooter"></span></span>
        <span class="footer-direito">Copyright 2025-2025</span>
    </footer>

    <script>
        const usuarioLogado = JSON.parse(localStorage.getItem('usuarioLogado'));
        if (usuarioLogado) {
            document.getElementById('nomeUsuarioDisplay').textContent = usuarioLogado.nome;
            document.getElementById('nomeUsuarioFooter').textContent = usuarioLogado.nome;
        }
    </script>

    <script>
        // 1. Vendas do Dia (por hora)
        const vendasPorHora = [10, 15, 20, 25, 30, 40, 50, 60, 40, 20, 10, 0]; // 12h de operação
        const totalVendasHoje = vendasPorHora.reduce((a, b) => a + b, 0);
        document.getElementById('totalVendasHoje').textContent = totalVendasHoje;
        const ctxVendasHora = document.getElementById('vendasPorHora').getContext('2d');
        new Chart(ctxVendasHora, {
            type: 'bar',
            data: {
                labels: ['06h', '07h', '08h', '09h', '10h', '11h', '12h', '13h', '14h', '15h', '16h', '17h'],
                datasets: [{
                    label: 'Itens vendidos',
                    data: vendasPorHora,
                    backgroundColor: '#f3a853'
                }]
            },
            options: {
                plugins: {
                    title: {
                        display: true,
                        text: 'Vendas por Hora'
                    }
                },
                responsive: true,
                maintainAspectRatio: false
            }
        });

        // 2. Produtos Mais Vendidos (Top 5) - sem imagens
        const topProdutos = [
            { nome: 'Pão Francês', qtd: 180 },
            { nome: 'Bolo de Chocolate', qtd: 90 },
            { nome: 'Café', qtd: 75 },
            { nome: 'Croissant', qtd: 60 },
            { nome: 'Sonho', qtd: 55 }
        ];
        const topProdutosOl = document.getElementById('topProdutosVendidos');
        topProdutos.forEach((prod, idx) => {
            const li = document.createElement('li');
            li.style.marginBottom = '0.5em';
            li.innerHTML = `<span style="font-size:1.2em; font-weight:bold; margin-right:0.5em;">${idx + 1}º</span>
                <span>${prod.nome} – ${prod.qtd} unidades</span>`;
            topProdutosOl.appendChild(li);
        });

        // 3. Comandas Abertas/Encerradas
        const comandasAbertas = 3;
        const comandasEncerradas = 54;
        document.getElementById('comandasAbertas').textContent = comandasAbertas;
        document.getElementById('comandasEncerradas').textContent = comandasEncerradas;

        // 4. Movimentação por Faixa de Horário (linha)
        const ctxMovHorario = document.getElementById('movimentacaoHorario').getContext('2d');
        new Chart(ctxMovHorario, {
            type: 'line',
            data: {
                labels: ['06h-08h', '08h-10h', '10h-12h', '12h-14h', '14h-16h', '16h-18h'],
                datasets: [{
                    label: 'Vendas',
                    data: [30, 60, 90, 110, 60, 20],
                    borderColor: '#4a9a2e',
                    backgroundColor: 'rgba(74,154,46,0.1)',
                    fill: true,
                    tension: 0.3
                }]
            },
            options: {
                plugins: {
                    title: {
                        display: true,
                        text: 'Movimentação por Faixa de Horário'
                    }
                },
                responsive: true,
                maintainAspectRatio: false
            }
        });

        // 5. Status dos PDVs
        const pdvs = [
            { nome: '0-00001', status: 'Ativo', ultima: '17:05' },
            { nome: '0-00002', status: 'Ativo', ultima: '17:03' },
            { nome: '0-00003', status: 'Inativo', ultima: '16:40' }
        ];
        const statusPdvsUl = document.getElementById('statusPdvs');
        pdvs.forEach(pdv => {
            const li = document.createElement('li');
            li.innerHTML = `<span style="font-weight:bold;">${pdv.nome}:</span> 
                <span style="color:${pdv.status === 'Ativo' ? '#4a9a2e' : '#fc5050'}">${pdv.status}</span>
                <span style="font-size:0.9em; color:#888;">(Última atividade: ${pdv.ultima})</span>`;
            statusPdvsUl.appendChild(li);
        });

        // 6. Itens em Baixa (Alerta Simples em lista)
        const itensBaixo = [
            { nome: 'Farinha' },
            { nome: 'Ovos' },
            { nome: 'Fermento' }
        ];
        const alertaEstoque = document.getElementById('alertaEstoqueBaixo');
        alertaEstoque.innerHTML = '';
        if (itensBaixo.length > 0) {
            itensBaixo.forEach(item => {
                const li = document.createElement('li');
                li.textContent = item.nome + ' com estoque baixo';
                alertaEstoque.appendChild(li);
            });
        } else {
            const li = document.createElement('li');
            li.textContent = 'Nenhum item com estoque baixo.';
            alertaEstoque.appendChild(li);
        }
    </script>

</body>

</html>